import{d as l}from"./chunk-M637VE7D.js";import{L as u,Mb as c,P as r,h as o,ha as n,rc as h}from"./chunk-WN5WO2N4.js";var p=class i{constructor(e,t){this.supabaseService=e;this.router=t;this.supabaseService.client.auth.getSession().then(({data:s})=>{this._session.set(s.session),this._user.set(s.session?.user??null)}),this.supabaseService.client.auth.onAuthStateChange((s,a)=>{this._session.set(a),this._user.set(a?.user??null),s==="SIGNED_IN"?this.router.url.includes("/login")&&this.router.navigate(["/home"]):s==="SIGNED_OUT"&&this.router.navigate(["/login"])})}_session=n(null);_user=n(null);session=this._session.asReadonly();user=this._user.asReadonly();isAuthenticated=c(()=>!!this._session());async signInWithEmail(e){return this.supabaseService.client.auth.signInWithOtp({email:e})}async signInWithPassword(e,t){return this.supabaseService.client.auth.signInWithPassword({email:e,password:t})}async isAuthenticatedAsync(){let{data:e}=await this.supabaseService.client.auth.getSession();return!!e.session}async signOut(){return this.supabaseService.client.auth.signOut()}getUserAsObservable(){return o(this.supabaseService.client.auth.getUser().then(({data:e})=>e.user))}static \u0275fac=function(t){return new(t||i)(r(h),r(l))};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})};export{p as a};
