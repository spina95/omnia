import{a as ve,b as Te}from"./chunk-7IONRGOO.js";import{a as xe,b as be,c as Ce,d as ye,e as we,f as De}from"./chunk-XEBZIC75.js";import{b as de,d as ce}from"./chunk-S7RT4Y2X.js";import"./chunk-3U37DZ2B.js";import{a as ke}from"./chunk-EVCQBTMK.js";import{a as _e}from"./chunk-RBJIUBH4.js";import{a as fe}from"./chunk-FGWKY6PU.js";import{a as B}from"./chunk-VIL67WYR.js";import{a as he}from"./chunk-2Y3G6OLQ.js";import{a as pe,b as A,d as H,e as me,f as ge,g as j,h as ue,r as F}from"./chunk-UI2YVUNN.js";import{$a as c,Ab as u,Bb as te,Cb as b,Db as ie,Fb as L,Gb as P,Hb as I,Ia as M,Ib as $,Jb as ne,K as U,Ma as y,Mb as oe,Q as E,Qa as v,Rb as re,Tb as ae,W as p,Wa as q,X as m,Y as k,Yb as se,Z as x,ab as r,bb as a,ca as z,cb as h,ha as f,ic as O,jb as T,jc as le,kb as g,kc as N,mb as d,nb as J,ob as K,qb as X,rb as Y,rc as w,sb as Z,wb as ee,xb as V,za as l}from"./chunk-5B5UU655.js";import{a as C,b as S}from"./chunk-VOSPIT4N.js";var Pe=["*"],Ie=(s,t,e)=>[s,t,e];function Oe(s,t){if(s&1&&(k(),r(0,"svg",6),h(1,"path",7),a()),s&2){let e=d();c("ngClass",e.getCheckSizeClasses())}}function Ne(s,t){if(s&1&&(r(0,"span",8),u(1),a()),s&2){let e=d();l(),b(" ",e.label," ")}}var G=class s{label;disabled=!1;size="md";set checked(t){this._checked=!!t}get checked(){return this._checked}checkedChange=new z;_checked=!1;onChange=()=>{};onTouched=()=>{};writeValue(t){this._checked=!!t}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}toggle(){this.disabled||(this._checked=!this._checked,this.onChange(this._checked),this.onTouched(),this.checkedChange.emit(this._checked))}getSizeClasses(){switch(this.size){case"sm":return"w-4 h-4";case"lg":return"w-6 h-6";default:return"w-5 h-5"}}getCheckSizeClasses(){switch(this.size){case"sm":return"w-2.5 h-2.5";case"lg":return"w-4 h-4";default:return"w-3 h-3"}}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=y({type:s,selectors:[["app-checkbox"]],inputs:{label:"label",disabled:"disabled",size:"size",checked:"checked"},outputs:{checkedChange:"checkedChange"},features:[ne([{provide:pe,useExisting:U(()=>s),multi:!0}])],ngContentSelectors:Pe,decls:7,vars:13,consts:[[1,"inline-flex","items-center","cursor-pointer","group"],[1,"relative",3,"click"],["type","checkbox","tabindex","-1",1,"sr-only",3,"checked","disabled"],[1,"checkbox-box","transition-all","duration-200","ease-in-out","rounded","border-2","flex","items-center","justify-center",3,"ngClass"],["class","text-black transition-transform duration-200 ease-in-out","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","3.5",3,"ngClass",4,"ngIf"],["class","ml-3 text-sm text-zinc-700 dark:text-zinc-300 select-none transition-colors duration-200",4,"ngIf"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","3.5",1,"text-black","transition-transform","duration-200","ease-in-out",3,"ngClass"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],[1,"ml-3","text-sm","text-zinc-700","dark:text-zinc-300","select-none","transition-colors","duration-200"]],template:function(e,n){e&1&&(J(),r(0,"label",0)(1,"div",1),g("click",function(){return n.toggle()}),h(2,"input",2),r(3,"div",3),v(4,Oe,2,1,"svg",4),a()(),v(5,Ne,2,1,"span",5),K(6),a()),e&2&&(V("cursor-not-allowed",n.disabled)("opacity-50",n.disabled),l(2),c("checked",n.checked)("disabled",n.disabled),l(),c("ngClass",oe(9,Ie,n.getSizeClasses(),n.checked?"bg-brand border-brand":"bg-white dark:bg-zinc-950 border-zinc-300 dark:border-zinc-600 group-hover:border-zinc-400 dark:group-hover:border-zinc-500",n.disabled?"":"cursor-pointer")),l(),c("ngIf",n.checked),l(),c("ngIf",n.label))},dependencies:[w,O,N],styles:[".checkbox-box[_ngcontent-%COMP%]{flex-shrink:0}input[_ngcontent-%COMP%]:focus-visible + .checkbox-box[_ngcontent-%COMP%]{outline:2px solid #3ecf8e;outline-offset:2px}.checkbox-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_checkmark-pop .2s ease-in-out}@keyframes _ngcontent-%COMP%_checkmark-pop{0%{transform:scale(0)}50%{transform:scale(1.1)}to{transform:scale(1)}}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}"]})};var R=class s{task=null;close=new z;saved=new z;title="";priority=null;category="task";priorityOptions=[{value:null,label:"No Priority"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];categoryOptions=[{value:"task",label:"Task"},{value:"idea",label:"Idea"},{value:"optional",label:"Optional"}];ngOnInit(){this.task&&(this.title=this.task.title||"",this.priority=this.task.priority||null,this.category=this.task.category||"task")}onDialogPriorityChange(t){this.priority=t}onDialogCategoryChange(t){this.category=t}onCancel(){this.close.emit()}onSave(){let t={title:this.title.trim(),priority:this.priority||void 0,category:this.category};this.saved.emit(t),this.close.emit()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=y({type:s,selectors:[["app-edit-task-dialog"]],inputs:{task:"task"},outputs:{close:"close",saved:"saved"},decls:19,vars:5,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/40"],[1,"bg-white","dark:bg-zinc-900","rounded-lg","p-6","w-full","max-w-md"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-3"],[1,"block","text-sm","font-medium","text-zinc-700","dark:text-zinc-300"],[1,"w-full","bg-white","dark:bg-zinc-800","border","border-zinc-300","dark:border-zinc-700","rounded","px-3","py-2",3,"ngModelChange","ngModel"],["placeholder","Priority",3,"selectionChange","options","value"],["placeholder","Category",3,"selectionChange","options","value"],[1,"mt-4","flex","justify-end","gap-2"],[1,"px-4","py-2","rounded","bg-zinc-200","dark:bg-zinc-800",3,"click"],[1,"px-4","py-2","rounded","bg-brand","text-black",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"h3",2),u(3,"Edit Task"),a(),r(4,"div",3)(5,"label",4),u(6,"Title"),a(),r(7,"input",5),I("ngModelChange",function(i){return P(n.title,i)||(n.title=i),i}),a(),r(8,"label",4),u(9,"Priority"),a(),r(10,"app-select",6),g("selectionChange",function(i){return n.onDialogPriorityChange(i)}),a(),r(11,"label",4),u(12,"Category"),a(),r(13,"app-select",7),g("selectionChange",function(i){return n.onDialogCategoryChange(i)}),a()(),r(14,"div",8)(15,"button",9),g("click",function(){return n.onCancel()}),u(16,"Cancel"),a(),r(17,"button",10),g("click",function(){return n.onSave()}),u(18,"Save"),a()()()()),e&2&&(l(7),L("ngModel",n.title),l(3),c("options",n.priorityOptions)("value",n.priority),l(3),c("options",n.categoryOptions)("value",n.category))},dependencies:[w,F,A,H,j,B],styles:["[_nghost-%COMP%]{display:block}"]})};var He=["headerActions"];function je(s,t){if(s&1){let e=T();r(0,"button",8),g("click",function(){p(e);let o=d();return m(o.goBack())}),k(),r(1,"svg",9),h(2,"path",10),a(),x(),r(3,"span",11),u(4,"Back"),a()(),r(5,"button",12),g("click",function(){p(e);let o=d();return m(o.openEditDialog())}),k(),r(6,"svg",9),h(7,"path",13),a(),x(),r(8,"span",11),u(9,"Edit"),a()(),r(10,"button",14),g("click",function(){p(e);let o=d();return m(o.confirmDeleteList())}),k(),r(11,"svg",9),h(12,"path",15),a(),x(),r(13,"span",11),u(14,"Delete"),a()()}}function Fe(s,t){s&1&&(r(0,"div",16),h(1,"div",17),a())}function Be(s,t){if(s&1&&(r(0,"div")(1,"p",48),u(2),a()()),s&2){let e=d(2);l(2),te(e.todoList().description)}}function Ge(s,t){if(s&1&&(r(0,"span",49),u(1),a()),s&2){let e=d(2);c("ngClass",e.getPriorityBadgeClass(e.todoList().priority)),l(),b(" ",e.getPriorityLabel(e.todoList().priority)," ")}}function Re(s,t){if(s&1&&(r(0,"span",49),k(),r(1,"svg",50),h(2,"path",51),a(),u(3),a()),s&2){let e=d(2);c("ngClass",e.getDueDateBadgeClass(e.todoList().due_date)),l(3),b(" ",e.getDueDateLabel(e.todoList().due_date)," ")}}function $e(s,t){s&1&&(k(),r(0,"svg",52),h(1,"path",53),a())}function We(s,t){s&1&&h(0,"div",54)}function Qe(s,t){s&1&&(r(0,"div",55),k(),r(1,"svg",56),h(2,"path",57),a(),x(),r(3,"p",58),u(4,"No tasks yet"),a(),r(5,"p",59),u(6,"Add your first task to get started"),a()())}function Ue(s,t){if(s&1){let e=T();r(0,"div",79)(1,"span",80),g("click",function(o){p(e);let i=d().$implicit,_=d(3);return m(_.startEditingTask(i,o))}),u(2),a()()}if(s&2){let e=d().$implicit;l(),V("line-through",e.completed)("text-zinc-400",e.completed)("dark:text-zinc-500",e.completed),l(),b(" ",e.title," ")}}function qe(s,t){if(s&1){let e=T();r(0,"input",81),I("ngModelChange",function(o){p(e);let i=d(4);return P(i.editingTaskTitle,o)||(i.editingTaskTitle=o),m(o)}),g("blur",function(){p(e);let o=d().$implicit,i=d(3);return m(i.saveTaskEdit(o))})("keydown.enter",function(){p(e);let o=d().$implicit,i=d(3);return m(i.saveTaskEdit(o))})("keydown.escape",function(){p(e);let o=d(4);return m(o.cancelTaskEdit())}),a()}if(s&2){let e=d(4);L("ngModel",e.editingTaskTitle),q("autofocus",!0)}}function Je(s,t){s&1&&h(0,"div",82)}function Ke(s,t){if(s&1){let e=T();r(0,"div",62)(1,"div",63)(2,"div",64),k(),r(3,"svg",52),h(4,"path",65),a()(),x(),r(5,"div",66),g("click",function(){let o=p(e).$implicit,i=d(3);return m(i.onToggleCompleted(o))}),h(6,"app-checkbox",67),a(),v(7,Ue,3,7,"div",68)(8,qe,1,2,"input",69),r(9,"div",70)(10,"button",71),g("click",function(o){let i=p(e).$implicit,_=d(3);return m(_.openEditTaskDialog(i,o))}),k(),r(11,"svg",52),h(12,"path",72),a()(),x(),r(13,"button",73),g("click",function(o){let i=p(e).$implicit,_=d(3);return m(_.confirmDeleteTask(i,o))}),k(),r(14,"svg",52),h(15,"path",15),a()()()(),x(),r(16,"div",74)(17,"div",75)(18,"span",76),u(19),a(),r(20,"span",76),u(21),a()(),r(22,"div",77)(23,"button",71),g("click",function(o){let i=p(e).$implicit,_=d(3);return m(_.openEditTaskDialog(i,o))}),k(),r(24,"svg",52),h(25,"path",72),a()(),x(),r(26,"button",73),g("click",function(o){let i=p(e).$implicit,_=d(3);return m(_.confirmDeleteTask(i,o))}),k(),r(27,"svg",52),h(28,"path",15),a()()()(),v(29,Je,1,0,"div",78),a()}if(s&2){let e=t.$implicit,n=d(3);l(6),c("checked",e.completed),l(),c("ngIf",n.editingTaskId()!==e.id),l(),c("ngIf",n.editingTaskId()===e.id),l(10),c("title",$(n.getTaskCategoryLabel(e.category)))("ngClass",n.getTaskCategoryBadgeClass(e.category)),l(),b(" ",n.getTaskCategoryLabel(e.category)," "),l(),c("title",$(n.getTaskPriorityLabel(e.priority)))("ngClass",n.getTaskPriorityBadgeClass(e.priority)),l(),b(" ",n.getTaskPriorityLabel(e.priority)," ")}}function Xe(s,t){if(s&1){let e=T();r(0,"div",60),g("cdkDropListDropped",function(o){p(e);let i=d(2);return m(i.onTaskDrop(o))}),v(1,Ke,30,11,"div",61),a()}if(s&2){let e=d(2);l(),c("ngForOf",e.tasks())}}function Ye(s,t){if(s&1){let e=T();r(0,"div",18)(1,"div",19),v(2,Be,3,1,"div",20),r(3,"div",21),v(4,Ge,2,2,"span",22)(5,Re,4,2,"span",22),a(),r(6,"div",23)(7,"div",24)(8,"span",25),u(9,"Overall Progress"),a(),r(10,"span",26),u(11),a()(),r(12,"div",27),h(13,"div",28),a(),r(14,"div",29),u(15),a()()(),r(16,"div",30)(17,"form",31),g("submit",function(o){p(e);let i=d();return o.preventDefault(),m(i.onAddTask())}),r(18,"input",32),g("input",function(o){p(e);let i=d();return m(i.newTaskTitle.set(o.target.value))}),a(),r(19,"div",33)(20,"app-select",34),g("selectionChange",function(o){p(e);let i=d();return m(i.onPriorityChange(o))}),a()(),r(21,"div",33)(22,"app-select",35),g("selectionChange",function(o){p(e);let i=d();return m(i.onCategoryChange(o))}),a()(),r(23,"button",36),v(24,$e,2,0,"svg",37)(25,We,1,0,"div",38),r(26,"span",39),u(27,"Add"),a()()()(),r(28,"div")(29,"div",40)(30,"h3",41),u(31,"Tasks"),a(),r(32,"div",42)(33,"span",43),u(34,"Sort by:"),a(),r(35,"div",44)(36,"app-select",45),g("selectionChange",function(o){p(e);let i=d();return m(i.onSortOrderChange(o))}),a()()()(),v(37,Qe,7,0,"div",46)(38,Xe,2,1,"div",47),a()()}if(s&2){let e,n,o,i=d();l(2),c("ngIf",(e=i.todoList())==null?null:e.description),l(2),c("ngIf",(n=i.todoList())==null?null:n.priority),l(),c("ngIf",(o=i.todoList())==null?null:o.due_date),l(6),ie(" ",i.getCompletedCount()," / ",i.getTotalCount()," tasks "),l(2),ee("width",i.getProgressPercentage(),"%"),V("bg-green-500",i.getProgressPercentage()===100)("bg-brand",i.getProgressPercentage()>=50&&i.getProgressPercentage()<100)("bg-yellow-500",i.getProgressPercentage()>0&&i.getProgressPercentage()<50)("bg-zinc-700",i.getProgressPercentage()===0),l(2),b(" ",i.getProgressPercentage(),"% Complete "),l(3),c("value",i.newTaskTitle())("disabled",i.addingTask()),l(2),c("options",i.priorityOptions)("value",i.newTaskPriority()),l(2),c("options",i.categoryOptions)("value",i.newTaskCategory()),l(),c("disabled",!i.newTaskTitle().trim()||i.addingTask()),l(),c("ngIf",!i.addingTask()),l(),c("ngIf",i.addingTask()),l(11),c("options",i.sortOptions)("value",i.sortOrder()),l(),c("ngIf",i.tasks().length===0),l(),c("ngIf",i.tasks().length>0)}}function Ze(s,t){if(s&1){let e=T();r(0,"app-add-todo-list-dialog",83),g("close",function(){p(e);let o=d();return m(o.closeEditDialog())})("save",function(){p(e);let o=d();return m(o.onSaveDialog())}),a()}if(s&2){let e=d();c("todoList",e.todoList())}}function et(s,t){if(s&1){let e=T();r(0,"app-edit-task-dialog",84),g("close",function(){p(e);let o=d();return m(o.closeEditTaskDialog())})("saved",function(o){p(e);let i=d();return m(i.onTaskDialogSaved(o))}),a()}if(s&2){let e=d();c("task",e.editingTaskForDialog())}}var ze=class s{constructor(t,e,n){this.todosService=t;this.notificationService=e;this.cdr=n}headerActionsTemplate;pageHeaderService=E(he);pageHeaderActionsService=E(fe);router=E(ce);route=E(de);todoList=f(null);tasks=f([]);loading=f(!1);newTaskTitle=f("");newTaskPriority=f("medium");newTaskCategory=f("task");addingTask=f(!1);sortOrder=f("none");showEditDialog=f(!1);showDeleteListConfirmation=f(!1);showDeleteTaskConfirmation=f(!1);taskToDelete=f(null);showEditTaskDialog=f(!1);editingTaskForDialog=f(null);editingTaskId=f(null);editingTaskTitle=f("");priorityOptions=[{value:null,label:"No Priority"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];categoryOptions=[{value:"task",label:"Task"},{value:"idea",label:"Idea"},{value:"optional",label:"Optional"}];sortOptions=[{value:"none",label:"Default Order"},{value:"priority-asc",label:"Priority Low to High"},{value:"priority-desc",label:"Priority High to Low"}];listId=ae(()=>this.route.snapshot.paramMap.get("id"));async ngOnInit(){let t=this.listId();t?(await this.loadList(t),await this.loadTasks(t)):this.router.navigate(["/todos"])}ngAfterViewInit(){this.pageHeaderActionsService.setActions(this.headerActionsTemplate),this.cdr.detectChanges()}ngOnDestroy(){this.pageHeaderActionsService.clearActions()}async loadList(t){this.loading.set(!0);let e=await this.todosService.getListById(t);e?(this.todoList.set(e),this.pageHeaderService.setHeader(e.title)):(this.notificationService.error("Todo list not found"),this.router.navigate(["/todos"])),this.loading.set(!1),this.cdr.detectChanges()}async loadTasks(t){let e=await this.todosService.getTasks(t);this.tasks.set(e),this.applySorting(),this.cdr.detectChanges()}applySorting(){let t=this.sortOrder(),e={high:3,medium:2,low:1,undefined:0};this.tasks.update(n=>{let o=n.filter(D=>!D.completed),i=n.filter(D=>D.completed),_=D=>D.sort((Ve,Me)=>{let W=e[Ve.priority||"undefined"],Q=e[Me.priority||"undefined"];return t==="priority-desc"?Q-W:t==="priority-asc"?W-Q:0});return(t==="priority-asc"||t==="priority-desc")&&(_(o),_(i)),[...o,...i]})}setSortOrder(t){this.sortOrder.set(t),this.applySorting()}async onAddTask(){let t=this.newTaskTitle().trim();if(!t){this.notificationService.error("Task title is required");return}let e=this.todoList();if(!e)return;this.addingTask.set(!0);let n=this.tasks().reduce((i,_)=>Math.max(i,_.order_index),-1),o=await this.todosService.createTask({list_id:e.id,title:t,completed:!1,order_index:n+1,priority:this.newTaskPriority(),category:this.newTaskCategory()});this.addingTask.set(!1),o?(this.newTaskTitle.set(""),this.newTaskPriority.set("medium"),this.newTaskCategory.set("task"),await this.loadTasks(e.id),this.notificationService.success("Task added successfully")):this.notificationService.error("Failed to add task")}async onToggleCompleted(t){await this.todosService.toggleTaskCompleted(t.id,!t.completed)?(this.tasks.update(n=>n.map(o=>o.id===t.id?S(C({},o),{completed:!o.completed}):o)),this.cdr.detectChanges()):this.notificationService.error("Failed to update task")}startEditingTask(t,e){e.stopPropagation(),this.editingTaskId.set(t.id),this.editingTaskTitle.set(t.title)}async saveTaskEdit(t){let e=this.editingTaskTitle().trim();if(!e){this.notificationService.error("Task title cannot be empty"),this.cancelTaskEdit();return}if(e===t.title){this.cancelTaskEdit();return}await this.todosService.updateTask(t.id,{title:e})?(this.tasks.update(o=>o.map(i=>i.id===t.id?S(C({},i),{title:e}):i)),this.notificationService.success("Task updated successfully"),this.cancelTaskEdit(),this.cdr.detectChanges()):this.notificationService.error("Failed to update task")}cancelTaskEdit(){this.editingTaskId.set(null),this.editingTaskTitle.set("")}confirmDeleteTask(t,e){e.stopPropagation(),this.taskToDelete.set(t),this.showDeleteTaskConfirmation.set(!0)}async onDeleteTaskConfirmed(){let t=this.taskToDelete();if(!t)return;if(await this.todosService.deleteTask(t.id)){let n=this.todoList();n&&await this.loadTasks(n.id),this.notificationService.success("Task deleted successfully")}else this.notificationService.error("Failed to delete task");this.showDeleteTaskConfirmation.set(!1),this.taskToDelete.set(null)}onDeleteTaskCancelled(){this.showDeleteTaskConfirmation.set(!1),this.taskToDelete.set(null)}async onTaskDrop(t){let e=this.todoList();if(!e)return;let n=[...this.tasks()];xe(n,t.previousIndex,t.currentIndex),this.tasks.set(n);let o=n.map(_=>_.id);await this.todosService.reorderTasks(e.id,o)||(this.notificationService.error("Failed to reorder tasks"),await this.loadTasks(e.id))}openEditDialog(){this.showEditDialog.set(!0)}closeEditDialog(){this.showEditDialog.set(!1)}async onSaveDialog(){let t=this.todoList();t&&await this.loadList(t.id)}confirmDeleteList(){this.showDeleteListConfirmation.set(!0)}async onDeleteListConfirmed(){let t=this.todoList();if(!t)return;await this.todosService.deleteList(t.id)?(this.notificationService.success("Todo list deleted successfully"),this.router.navigate(["/todos"])):this.notificationService.error("Failed to delete todo list"),this.showDeleteListConfirmation.set(!1)}onDeleteListCancelled(){this.showDeleteListConfirmation.set(!1)}goBack(){this.router.navigate(["/todos"])}getPriorityBadgeClass(t){switch(t){case"high":return"bg-red-500/20 text-red-400 border-red-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-green-500/20 text-green-400 border-green-500/30";default:return"bg-zinc-800 text-zinc-400 border-zinc-700"}}getPriorityLabel(t){return t?t.charAt(0).toUpperCase()+t.slice(1):"No Priority"}getDueDateBadgeClass(t){if(!t)return"";let e=new Date;e.setHours(0,0,0,0);let n=new Date(t);n.setHours(0,0,0,0);let o=n.getTime()-e.getTime(),i=Math.ceil(o/(1e3*60*60*24));return i<0?"bg-red-500/20 text-red-400 border-red-500/30":i===0?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":i<=3?"bg-brand/20 text-brand border-brand/30":"bg-zinc-800 text-zinc-400 border-zinc-700"}getDueDateLabel(t){if(!t)return"";let e=new Date;e.setHours(0,0,0,0);let n=new Date(t);n.setHours(0,0,0,0);let o=n.getTime()-e.getTime(),i=Math.ceil(o/(1e3*60*60*24));return i<0?`Overdue ${Math.abs(i)}d`:i===0?"Due Today":i===1?"Due Tomorrow":i<=7?`Due in ${i}d`:n.toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"})}formatDate(t){return new Date(t).toLocaleDateString("it-IT",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}getCompletedCount(){return this.tasks().filter(t=>t.completed).length}getTotalCount(){return this.tasks().length}getProgressPercentage(){let t=this.getTotalCount();return t===0?0:Math.round(this.getCompletedCount()/t*100)}getTaskPriorityBadgeClass(t){switch(t){case"high":return"bg-red-500/20 text-red-400 border-red-500/30";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"low":return"bg-green-500/20 text-green-400 border-green-500/30";default:return"bg-zinc-800 text-zinc-500 border-zinc-700"}}getTaskPriorityLabel(t){return t?t.charAt(0).toUpperCase()+t.slice(1):"No Priority"}getTaskCategoryBadgeClass(t){switch(t){case"task":return"bg-brand/20 text-brand border-brand/30";case"idea":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"optional":return"bg-zinc-700/20 text-zinc-400 border-zinc-600/30";default:return"bg-zinc-800 text-zinc-500 border-zinc-700"}}getTaskCategoryLabel(t){return t?t.charAt(0).toUpperCase()+t.slice(1):"Task"}onPriorityChange(t){this.newTaskPriority.set(t)}onCategoryChange(t){this.newTaskCategory.set(t)}onSortOrderChange(t){this.setSortOrder(t)}async updateTaskPriority(t,e){let n=e===null?void 0:e;await this.todosService.updateTask(t.id,{priority:n})?(this.tasks.update(i=>i.map(_=>_.id===t.id?S(C({},_),{priority:n}):_)),this.notificationService.success("Task priority updated"),this.cdr.detectChanges()):this.notificationService.error("Failed to update task priority")}async updateTaskCategory(t,e){let n=e;await this.todosService.updateTask(t.id,{category:n})?(this.tasks.update(i=>i.map(_=>_.id===t.id?S(C({},_),{category:n}):_)),this.notificationService.success("Task category updated"),this.cdr.detectChanges()):this.notificationService.error("Failed to update task category")}openEditTaskDialog(t,e){e&&e.stopPropagation(),this.editingTaskForDialog.set(t),this.showEditTaskDialog.set(!0),this.cdr.detectChanges()}closeEditTaskDialog(){this.showEditTaskDialog.set(!1),this.editingTaskForDialog.set(null)}async onTaskDialogSaved(t){let e=this.editingTaskForDialog();if(!e)return;await this.todosService.updateTask(e.id,t)?(this.tasks.update(o=>o.map(i=>i.id===e.id?C(C({},i),t):i)),this.notificationService.success("Task updated"),this.cdr.detectChanges()):this.notificationService.error("Failed to update task"),this.closeEditTaskDialog()}static \u0275fac=function(e){return new(e||s)(M(ve),M(_e),M(se))};static \u0275cmp=y({type:s,selectors:[["app-todo-detail"]],viewQuery:function(e,n){if(e&1&&X(He,5),e&2){let o;Y(o=Z())&&(n.headerActionsTemplate=o.first)}},decls:10,vars:16,consts:[["headerActions",""],[1,"h-full"],[1,"p-3","sm:p-6","space-y-4","sm:space-y-6"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","space-y-6",4,"ngIf"],[3,"todoList","close","save",4,"ngIf"],[3,"task","close","saved",4,"ngIf"],[3,"confirmed","cancelled","isOpen","title","message","confirmText","iconType","isDangerous"],["title","Back to Lists",1,"flex","items-center","justify-center","gap-2","px-2","sm:px-4","py-2.5","h-10","text-sm","bg-zinc-800","text-white","rounded-lg","hover:bg-zinc-700","transition-colors","border","border-zinc-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"hidden","sm:inline","whitespace-nowrap"],["title","Edit List",1,"flex","items-center","justify-center","gap-2","px-2","sm:px-4","py-2.5","h-10","text-sm","bg-zinc-800","text-white","rounded-lg","hover:bg-zinc-700","transition-colors","border","border-zinc-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Delete List",1,"flex","items-center","justify-center","gap-2","px-2","sm:px-4","py-2.5","h-10","text-sm","bg-red-900/20","text-red-400","rounded-lg","hover:bg-red-900/30","transition-colors","border","border-red-500/30",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"flex","justify-center","items-center","h-64"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-brand"],[1,"space-y-6"],[1,"bg-white","dark:bg-background-card","rounded-lg","border","border-zinc-300","dark:border-zinc-800","p-6","space-y-4","transition-colors","duration-200"],[4,"ngIf"],[1,"flex","flex-wrap","items-center","gap-2"],["class","inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium border",3,"ngClass",4,"ngIf"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"text-zinc-400","font-medium"],[1,"text-zinc-300","font-semibold"],[1,"h-3","bg-zinc-200","dark:bg-zinc-800","rounded-full","overflow-hidden","transition-colors","duration-200"],[1,"h-full","transition-all","duration-300","rounded-full"],[1,"text-xs","text-zinc-500","text-right"],[1,"mb-4","space-y-3"],[1,"flex","flex-col","sm:flex-row","gap-3",3,"submit"],["type","text","placeholder","Add a new task...",1,"flex-1","bg-white","dark:bg-zinc-950","border","border-zinc-300","dark:border-zinc-700","rounded-lg","px-4","py-2.5","text-zinc-900","dark:text-white","placeholder-zinc-400","dark:placeholder-zinc-500","focus:outline-none","focus:ring-2","focus:ring-brand","focus:border-transparent","transition-colors","duration-200",3,"input","value","disabled"],[1,"min-w-[140px]"],["placeholder","Priority",3,"selectionChange","options","value"],["placeholder","Category",3,"selectionChange","options","value"],["type","submit",1,"flex","items-center","justify-center","gap-2","px-4","py-2.5","bg-brand","text-black","font-medium","rounded-lg","hover:bg-brand/90","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["class","h-5 w-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","animate-spin h-5 w-5 border-2 border-black border-t-transparent rounded-full",4,"ngIf"],[1,"hidden","sm:inline"],[1,"mb-4","flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-3"],[1,"text-lg","font-medium","text-zinc-900","dark:text-white"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-zinc-500","dark:text-zinc-400"],[1,"min-w-[180px]"],["placeholder","Sort order",3,"selectionChange","options","value"],["class","flex flex-col items-center justify-center py-12 text-zinc-500",4,"ngIf"],["cdkDropList","","class","space-y-2",3,"cdkDropListDropped",4,"ngIf"],[1,"text-zinc-600","dark:text-zinc-300"],[1,"inline-flex","items-center","px-3","py-1.5","rounded-full","text-sm","font-medium","border",3,"ngClass"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"animate-spin","h-5","w-5","border-2","border-black","border-t-transparent","rounded-full"],[1,"flex","flex-col","items-center","justify-center","py-12","text-zinc-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-16","w-16","mb-4","opacity-50"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"text-lg","font-medium","mb-2"],[1,"text-sm"],["cdkDropList","",1,"space-y-2",3,"cdkDropListDropped"],["cdkDrag","","class","group flex flex-col sm:flex-row sm:items-center gap-3 px-4 py-3 bg-zinc-100 dark:bg-zinc-800/50 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-lg border border-zinc-300 dark:border-zinc-700 hover:border-zinc-400 dark:hover:border-zinc-600 transition-all cursor-move duration-200",4,"ngFor","ngForOf"],["cdkDrag","",1,"group","flex","flex-col","sm:flex-row","sm:items-center","gap-3","px-4","py-3","bg-zinc-100","dark:bg-zinc-800/50","hover:bg-zinc-200","dark:hover:bg-zinc-800","rounded-lg","border","border-zinc-300","dark:border-zinc-700","hover:border-zinc-400","dark:hover:border-zinc-600","transition-all","cursor-move","duration-200"],[1,"flex","items-center","gap-3","flex-1","min-w-0"],["cdkDragHandle","",1,"flex","items-center","text-zinc-500","group-hover:text-zinc-400","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 8h16M4 16h16"],[1,"flex","items-center","flex-shrink-0",3,"click"],[1,"pointer-events-none","flex","items-center",3,"checked"],["class","flex-1 min-w-0",4,"ngIf"],["type","text","class","flex-1 min-w-0 bg-white dark:bg-zinc-900 border border-brand rounded px-2 py-1 text-zinc-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-brand transition-colors duration-200",3,"ngModel","ngModelChange","blur","keydown.enter","keydown.escape",4,"ngIf"],[1,"hidden","sm:flex","items-center","gap-2","opacity-0","group-hover:opacity-100","transition-opacity","flex-shrink-0"],["title","Edit task",1,"p-2","text-zinc-400","hover:text-brand","transition-all","rounded","hover:bg-zinc-700",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L14.121 4.121a1 1 0 00-1.414 0L3.293 13.535A1 1 0 003 14.242V19a1 1 0 001 1z"],["title","Delete task",1,"p-2","text-zinc-400","hover:text-red-400","transition-all","rounded","hover:bg-zinc-700",3,"click"],[1,"flex","items-center","justify-between","gap-2","pl-11","sm:pl-0"],[1,"flex","items-center","gap-2","flex-wrap"],[1,"inline-flex","items-center","px-2","py-0.5","rounded","text-xs","font-medium","border","whitespace-nowrap",3,"ngClass","title"],[1,"flex","sm:hidden","items-center","gap-2","flex-shrink-0"],["class","h-20 sm:h-14 bg-zinc-700/50 border-2 border-dashed border-brand rounded-lg",4,"cdkDragPlaceholder"],[1,"flex-1","min-w-0"],[1,"text-zinc-900","dark:text-white","transition-all","cursor-text","duration-200","block","break-words",3,"click"],["type","text",1,"flex-1","min-w-0","bg-white","dark:bg-zinc-900","border","border-brand","rounded","px-2","py-1","text-zinc-900","dark:text-white","focus:outline-none","focus:ring-2","focus:ring-brand","transition-colors","duration-200",3,"ngModelChange","blur","keydown.enter","keydown.escape","ngModel"],[1,"h-20","sm:h-14","bg-zinc-700/50","border-2","border-dashed","border-brand","rounded-lg"],[3,"close","save","todoList"],[3,"close","saved","task"]],template:function(e,n){if(e&1){let o=T();v(0,je,15,0,"ng-template",null,0,re),r(2,"div",1)(3,"div",2),v(4,Fe,2,0,"div",3)(5,Ye,39,29,"div",4),a()(),v(6,Ze,1,1,"app-add-todo-list-dialog",5)(7,et,1,1,"app-edit-task-dialog",6),r(8,"app-confirmation-dialog",7),g("confirmed",function(){return p(o),m(n.onDeleteListConfirmed())})("cancelled",function(){return p(o),m(n.onDeleteListCancelled())}),a(),r(9,"app-confirmation-dialog",7),g("confirmed",function(){return p(o),m(n.onDeleteTaskConfirmed())})("cancelled",function(){return p(o),m(n.onDeleteTaskCancelled())}),a()}if(e&2){let o,i;l(4),c("ngIf",n.loading()),l(),c("ngIf",!n.loading()&&n.todoList()),l(),c("ngIf",n.showEditDialog()),l(),c("ngIf",n.showEditTaskDialog()),l(),c("isOpen",n.showDeleteListConfirmation())("title","Delete Todo List")("message",'Are you sure you want to delete "'+((o=n.todoList())==null?null:o.title)+'"? This will also delete all tasks in this list. This action cannot be undone.')("confirmText","Delete")("iconType","error")("isDangerous",!0),l(),c("isOpen",n.showDeleteTaskConfirmation())("title","Delete Task")("message",'Are you sure you want to delete "'+((i=n.taskToDelete())==null?null:i.title)+'"? This action cannot be undone.')("confirmText","Delete")("iconType","error")("isDangerous",!0)}},dependencies:[w,O,le,N,F,ue,A,H,me,j,ge,De,ye,Ce,be,we,ke,G,B,Te,R],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:.5rem;box-shadow:0 5px 15px #0000004d}.cdk-drag-animating[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}"]})};export{ze as TodoDetailComponent};
