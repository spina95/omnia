import{b as U}from"./chunk-EODEEVHI.js";import{d as Y}from"./chunk-S7RT4Y2X.js";import"./chunk-3U37DZ2B.js";import{a as q}from"./chunk-RBJIUBH4.js";import{a as K}from"./chunk-FGWKY6PU.js";import{a as J}from"./chunk-2Y3G6OLQ.js";import{Ab as m,Cb as S,Db as L,Ma as A,Q as l,Ra as F,Rb as G,W as h,Wa as N,X as C,Xa as b,Ya as M,Yb as B,Za as y,_a as D,db as a,eb as i,fb as I,ha as v,jb as E,lb as w,mb as c,qb as z,rb as H,rc as Q,sb as V,wb as $,xb as R,za as d}from"./chunk-5B5UU655.js";import"./chunk-VOSPIT4N.js";var ee=["headerActions"],te=(o,t)=>t.month,oe=(o,t)=>t.date;function ne(o,t){if(o&1){let e=E();a(0,"button",4),w("click",function(){h(e);let r=c();return C(r.goBack())}),m(1," \u2190 Back to planner "),i()}}function ae(o,t){o&1&&(a(0,"div",2),I(1,"div",5),i())}function ie(o,t){if(o&1&&(a(0,"span"),m(1),i()),o&2){let e=c().$implicit,n=c(3);d(),L("",e.emoji," ",n.getMoodLabel(e.mood))}}function re(o,t){o&1&&(a(0,"span",17),m(1,"No mood"),i())}function de(o,t){if(o&1){let e=E();a(0,"div",13),w("click",function(){let r=h(e).$implicit,_=c(3);return C(_.navigateToDay(r.date))}),a(1,"div",14)(2,"div",15),m(3),i(),a(4,"div",16),b(5,ie,2,2,"span")(6,re,2,0,"span",17),i()()()}if(o&2){let e=t.$implicit,n=c(3);$("background-color",e.color),R("has-mood",e.mood),N("data-date",e.date)("data-day",e.day)("data-mood",n.getMoodLabel(e.mood))("data-emoji",e.emoji),d(3),S(" ",e.date," "),d(2),M(e.mood?5:6)}}function le(o,t){if(o&1&&(a(0,"div",8)(1,"div",9)(2,"span",10),m(3),i()(),a(4,"div",11),y(5,de,7,10,"div",12,oe),i()()),o&2){let e=t.$implicit;d(3),S(" ",e.name," "),d(2),D(e.days)}}function ce(o,t){if(o&1&&(a(0,"div",3)(1,"div",6)(2,"div",7),y(3,le,7,1,"div",8,te),i()()()),o&2){let e=c();d(3),D(e.monthsData())}}var O={great:{emoji:"\u{1F60A}",color:"#22c55e",label:"Great"},good:{emoji:"\u{1F642}",color:"#84cc16",label:"Good"},neutral:{emoji:"\u{1F610}",color:"#eab308",label:"Neutral"},tired:{emoji:"\u{1F634}",color:"#8b5cf6",label:"Tired"},bad:{emoji:"\u{1F614}",color:"#f97316",label:"Bad"},angry:{emoji:"\u{1F620}",color:"#ef4444",label:"Angry"},stressed:{emoji:"\u{1F630}",color:"#dc2626",label:"Stressed"}},W=class o{plannerService=l(U);pageHeaderService=l(J);pageHeaderActionsService=l(K);notificationService=l(q);router=l(Y);cdr=l(B);headerActionsTemplate;loading=v(!1);monthsData=v([]);async ngOnInit(){this.pageHeaderService.setHeader("Mood Calendar"),await this.loadMoodData()}ngAfterViewInit(){this.pageHeaderActionsService.setActions(this.headerActionsTemplate),this.cdr.detectChanges()}ngOnDestroy(){this.pageHeaderActionsService.clearActions()}async loadMoodData(){this.loading.set(!0);try{let t=new Date,e=new Date;e.setMonth(e.getMonth()-11),e.setDate(1);let n=this.formatDate(e),r=this.formatDate(t),_=await this.plannerService.getMoodHistory(n,r),T=new Map;_.forEach(s=>{T.set(s.date,s.mood)});let P=[],g=new Date(e);for(let s=0;s<12;s++){let u=g.getFullYear(),f=g.getMonth(),X=new Date(u,f+1,0).getDate(),j=[];for(let x=1;x<=X;x++){let Z=new Date(u,f,x),k=this.formatDate(Z),p=T.get(k)||null;j.push({date:k,day:x,mood:p,emoji:p&&O[p]?.emoji||"",color:p?O[p]?.color||"#4b5563":"#27272a"})}P.push({name:this.getMonthName(f),year:u,month:f,days:j}),g.setMonth(g.getMonth()+1)}this.monthsData.set(P)}catch(t){console.error("Error loading mood data:",t),this.notificationService.error("Error loading mood calendar")}finally{this.loading.set(!1)}}navigateToDay(t){this.router.navigate(["/planner/day",t])}goBack(){this.router.navigate(["/planner/today"])}formatDate(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`}getMonthName(t){return["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"][t]}getMoodLabel(t){return t?O[t]?.label||t:"No mood"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=A({type:o,selectors:[["app-mood-calendar"]],viewQuery:function(e,n){if(e&1&&z(ee,5),e&2){let r;H(r=V())&&(n.headerActionsTemplate=r.first)}},decls:5,vars:1,consts:[["headerActions",""],[1,"container","mx-auto","px-4","py-6","max-w-7xl"],[1,"flex","items-center","justify-center","py-12"],[1,"space-y-8"],[1,"px-3","py-1.5","bg-zinc-800","text-zinc-300","rounded-md","hover:bg-zinc-700","transition-colors","text-sm",3,"click"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-brand"],[1,"bg-zinc-800/50","dark:bg-zinc-900/50","rounded-lg","p-6","border","border-zinc-700/50"],[1,"space-y-2"],[1,"flex","items-center","gap-3"],[1,"w-12","flex-shrink-0"],[1,"text-xs","font-semibold","text-zinc-400"],[1,"mood-grid","flex-1"],[1,"mood-cell","group",3,"background-color","has-mood"],[1,"mood-cell","group",3,"click"],[1,"mood-tooltip"],[1,"text-xs","font-medium"],[1,"text-sm","mt-1"],[1,"text-zinc-500"]],template:function(e,n){e&1&&(a(0,"div",1),F(1,ne,2,0,"ng-template",null,0,G),b(3,ae,2,0,"div",2)(4,ce,5,0,"div",3),i()),e&2&&(d(3),M(n.loading()?3:4))},dependencies:[Q],styles:['.mood-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(14px,14px));gap:3px;justify-content:start}.mood-cell[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:2px;cursor:pointer;position:relative;transition:all .2s ease;border:1px solid rgba(0,0,0,.2)}.mood-cell[_ngcontent-%COMP%]:hover{transform:scale(1.3);z-index:10;border-color:#ffffff80}.mood-cell.has-mood[_ngcontent-%COMP%]{box-shadow:0 0 0 1px #0000001a}.mood-tooltip[_ngcontent-%COMP%]{position:absolute;bottom:calc(100% + 8px);left:50%;transform:translate(-50%);background-color:#18181b;color:#e4e4e7;padding:8px 12px;border-radius:6px;font-size:12px;white-space:nowrap;pointer-events:none;opacity:0;transition:opacity .2s ease;z-index:1000;border:1px solid #3f3f46;box-shadow:0 4px 12px #00000080}.mood-tooltip[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;left:50%;transform:translate(-50%);border:5px solid transparent;border-top-color:#18181b}.mood-cell[_ngcontent-%COMP%]:hover   .mood-tooltip[_ngcontent-%COMP%]{opacity:1}@media(min-width:640px){.mood-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(16px,16px));gap:4px}.mood-cell[_ngcontent-%COMP%]{width:16px;height:16px}}@media(min-width:1024px){.mood-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(18px,18px));gap:4px}.mood-cell[_ngcontent-%COMP%]{width:18px;height:18px}}']})};export{W as MoodCalendarComponent};
